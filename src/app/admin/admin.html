<div *ngIf="apiService.isAdmin(); else notAllowed" class="admin-panel">
  <div class="admin-header">
    <h2>KullanÄ±cÄ± YÃ¶netimi</h2>
    <button class="primary" (click)="goToMap()">Haritaya DÃ¶n</button>
  </div>

  <!-- ARAMA PANELÄ° -->
  <form class="search-panel" (ngSubmit)="$event.preventDefault()">
    <input
      type="text"
      placeholder="KullanÄ±cÄ± adÄ± veya e-posta ara"
      [(ngModel)]="searchQuery"
      name="query"
      autocomplete="off"
    />
    <select [(ngModel)]="searchRole" name="role">
      <option value="">TÃ¼m Roller</option>
      <option value="admin">Admin</option>
      <option value="user">User</option>
    </select>
    <button type="submit" class="primary">Ara</button>
  </form>
  <!-- /ARAMA PANELÄ° -->

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>KullanÄ±cÄ± AdÄ±</th>
          <th>Email</th>
          <th>Rol</th>
          <th>Ä°ÅŸlemler</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers">
          <td>{{user.username}}</td>
          <td>{{user.email}}</td>
          <td>
            <span [ngClass]="{
              'role-badge': true,
              'admin-badge': user.role.toLowerCase() === 'admin',
              'user-badge': user.role.toLowerCase() !== 'admin'
            }">{{user.role}}</span>
          </td>
          <td>
            <button class="edit" (click)="openEditModal(user)">DÃ¼zenle</button>
            <button class="delete" (click)="openDeleteModal(user)">Sil</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Edit Modal -->
  <div class="modal" *ngIf="isEditModalOpen">
    <div class="modal-content">
      <h3>KullanÄ±cÄ± DÃ¼zenle</h3>
      <form (ngSubmit)="saveEdit()">
        <label>
          KullanÄ±cÄ± AdÄ±:
          <input [(ngModel)]="editUsername" name="editUsername" required>
        </label>
        <label>
          Email:
          <input [(ngModel)]="editEmail" name="editEmail" type="email" required>
        </label>
        <label>
          Rol:
          <select [(ngModel)]="editRole" name="editRole">
            <option value="ADMIN">Admin</option>
            <option value="USER">User</option>
          </select>
        </label>
        <div class="modal-actions">
          <button type="submit" class="primary">Kaydet</button>
          <button type="button" (click)="isEditModalOpen=false">Ä°ptal</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Delete Modal -->
  <div class="modal" *ngIf="isDeleteModalOpen">
    <div class="modal-content">
      <h3>KullanÄ±cÄ± Sil</h3>
      <p>Bu kullanÄ±cÄ±yÄ± silmek istediÄŸinize emin misiniz?</p>
      <div class="modal-actions">
        <button class="delete" (click)="confirmDelete()">Evet, Sil</button>
        <button type="button" (click)="isDeleteModalOpen=false">VazgeÃ§</button>
      </div>
    </div>
  </div>
</div>

<ng-template #notAllowed>
  <div class="not-allowed">
    <span class="icon">ğŸš«</span>
    <p>Bu sayfaya eriÅŸim yetkiniz yok.</p>
  </div>
</ng-template>